\ProvidesPackage{ScreenStyle}

% I should split this up into a style sheet and a preamble.
% Inside a style sheet, the correct behaviour is to use RequirePackage rather
% than RequirePackage

% * Packages
% ** General
%\RequirePackage{~/Dropbox/profiles/Templates/LaTeX/texnotePreamble.sty}
\RequirePackage[utf8]{inputenc}
%\RequirePackage{fontspec} %More support for fonts in XeTeX
%\RequirePackage[Latin,Greek,Emoticons]{ucharclasses}
%\RequirePackage[framemethod=tikz]{mdframed}
\RequirePackage{comment}
\RequirePackage{mathtools}
\RequirePackage{import} %This is allows relative directories
% \RequirePackage{tikz}
\RequirePackage{xcolor}
%\usetikzlibrary{calc}
%\RequirePackage{chngcntr}
\RequirePackage[T1]{fontenc}
%\RequirePackage{extsizes} % More Font Sizes
\RequirePackage[utf8]{inputenc}
%\RequirePackage{sectsty} %Need it for underlining Sections
                           % Titlesec is incompatible with org-mode (Maybe not sure)
\RequirePackage{lmodern}
\RequirePackage{enumitem}
\RequirePackage{ifxetex,ifluatex} % This doesn't work with org-mode
\RequirePackage{lipsum}
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}
\RequirePackage[mono=false]{libertine} %% No UTF8 in mono,
\setlength{\tabcolsep}{6pt}
  \RequirePackage[margin = 1in]{geometry}
% \RequirePackage{canoniclayout}
\setlength{\columnsep}{0.75in} % Set column seperation
%\twocolumn
\addtolength{\skip\footins}{2pc plus 5pt} %Add whitespace before footnotes`
% ** Styles
% *** Colours
%\RequirePackage[svgnames, x11names, dvipsnames]{xcolor} %This is included with mdframed
% ** Graphics
\RequirePackage{graphicx}
% ** AmsMath
\RequirePackage{amsmath, amssymb, amsthm}

%Use this to put it in TOC
%\printbibliography[heading=bibintoc, title={Whole bibliography}]
%\printbibliography[heading=subbibintoc,type=article,title={Articles only}]
% ** Bibliography (refer to ./referencing.sty )
% % \RequirePackage[citestyle=numeric, bibstyle=numeric,hyperref=true,backref=true, maxcitenames=3,url=true,backend=biber,natbib=true]{biblatex}
% % \addbibresource{references.bib}
% % \AtEndDocument{\printbibliography}

%Use this to put it in TOC
%\printbibliography[heading=bibintoc, title={Whole bibliography}]
%\printbibliography[heading=subbibintoc,type=article,title={Articles only}]
% ** Hyperref (Last)

%Hyperlinks----------------must load last ---------------
\RequirePackage{bibentry}
\RequirePackage{hyperref}
\hypersetup{
	colorlinks,
	citecolor=black,
	filecolor=black,
	linkcolor=black,
	urlcolor=blue,
	 colorlinks=true, %set true if you want colored links
	 linktoc=all, %set to all if you want both sections and subsections linked
   backref=page %hyperlink references
}
% * Styling/Aesthetics
% % * Styling/Aesthetics
% ** Section Numbering
%Remove Section Numbers----------------
% \makeatletter
% \renewcommand{\@seccntformat}[1]{}
% \makeatother
%
% % Numbering
% \renewcommand{\thesection}{}
% \renewcommand{\thesubsection}{}
%%%%%%%%%%%%%%%%%%%5
\renewcommand{\thesection}{~\arabic{section}~}
\setcounter{subsection}{1}
\renewcommand{\thesubsection}{~\arabic{section}.\arabic{subsection}~}
\setcounter{subsubsection}{1}
\renewcommand{\thesubsubsection}{~\arabic{section}.\arabic{subsection}.\arabic{subsubsection}~}
\setcounter{secnumdepth}{4}
% ** Section Names
% Rename Chapters because a reports not a book
% \renewcommand{\chaptername}{Division}


% ** New Lines no Indent for paragraphs
\usepackage[parfill]{parskip}
% ** Font Style
% ** Penalise Page Breaks
% Formatting----------------------------------------
\widowpenalty=500 % use 500 or something huge like 10000
\clubpenalty=500     % https://www.texfaq.org/FAQ-widows
 \raggedbottom      % Let pages stop earlier for better breaking
% ** Problem Boxes

% Problem boxes --------------------------------------

%\newtheorem*{prob}{Problem}
%\theoremstyle{working}{\cmss}
%\newtheorem*{working}{Worked Solution}
\renewcommand{\qedsymbol}{$\blacksquare$}

\newenvironment{sol}[1][Problem]{%
	\proof[\nopunct]  %
}{\endproof}

%\renewenvironment{proof}{{\bfseries \fontfamily{ccr} \selectfont Proof}}{*something*}
% ** Heading Style
% *** Define Heading Colours
% These probably need some work to be honest
%\definecolor{part}{RGB}{136, 73, 143}
%\definecolor{chap}{RGB}{34, 174, 209}
\definecolor{sec}{HTML}{1A1423}
\definecolor{subsec}{HTML}{372549}
\definecolor{subsubsec}{HTML}{C2948A}
\definecolor{paragraph}{HTML}{7EA8BE}
\definecolor{subparagrap}{HTML}{17A398}
\RequirePackage{booktabs}

% sectsty is by far the easiest way to style sections, use that (but only on it's own)


\RequirePackage[]{sectsty}

% *** Change Colours
% **** Section
\sectionfont{\color{sec}}
% **** SubSection
\subsectionfont{\color{subsec}}
% **** SubSubSection
\subsubsectionfont{\color{subsubsec}}
% **** Paragraph
\paragraphfont{\color{paragraph}}
% **** SubParagraph
\paragraphfont{\color{subparagraph}}

% *** Actually Just use One style Instead
\definecolor{midnightblue}{rgb}{0.1, 0.1, 0.44}
%\allsectionsfont{  \mdseries\itshape\underline }
\allsectionsfont{ \color{midnightblue} \sffamily}



%
% ** Header
\RequirePackage{fancyhdr}
\RequirePackage{lastpage}
\pagestyle{fancy}
\cfoot[]{}
\rfoot{\thepage\ of \pageref{LastPage}}
\usepackage[bottom]{footmisc} % Makes footnotes go to the bottom which helps

\renewcommand{\headrulewidth}{0.3mm}% 2pt header rule
\renewcommand{\footrulewidth}{0.3mm}% 2pt header rule
\renewcommand{\headrule}{\hbox to\headwidth{%
  \color{midnightblue}\leaders\hrule height \headrulewidth\hfill}}
\renewcommand{\footrule}{\hbox to\headwidth{%
  \color{midnightblue}\leaders\hrule height \headrulewidth\hfill}}

%
% For \usepackage{fancyheadings}
    % \renewcommand{\headrulewidth{0.1mm}}
    % \renewcommand{\footrulewidth{0.1mm}} % looks weird with footnotes
    %

% * Code Blocks
% ** Listings Package

% Careful, this supports few languages
\RequirePackage{listings}


%Listings----------------------------------------


\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\lstset{
%  frame=tb,
  frame=shadowbox,
%  backgroundcolor=\color{lightlightgray},
  framesep=15pt,
  language=R,
  aboveskip=15pt,
  belowskip=20pt,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\footnotesize\ttfamily},
  numbers=none,
%  backgroundcolor=\color{Snow2},
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3,
  xleftmargin=1in,
  breaklines=true,
  postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space}
}

% ** Minted Package
% *** With Box
% I prefer this because:
   %+ It has support for more languages
      %+ listings would break =org-mode= when using emacs-lisp or elisp
   %+ linbreaks easily by default


% you need to install python, pygments and compile latex with the =-shell-escape= flag

\RequirePackage{minted}
\setminted{linenos,tabsize=2,breaklines, breakanywhere}
\RequirePackage{mdframed}
%
% \mdfsetup{
%   linecolor=blue!75!black,
%   linewidth=2pt,
% frametitlerule=true,
% frametitlebackgroundcolor=gray!20,
% innertopmargin=\topskip
% }
% \surroundwithmdframed{minted}
 \RequirePackage{etoolbox}

\RequirePackage{tcolorbox}
% Use tcolorbox, even though it breaks html conversion, it makes it way easier,
  %if you need to fix the html conversion just remove the box by commenting this out.
\tcbuselibrary{breakable, most, minted}
\tcbset{
%    breakable, enhanced jigsaw, %Don't break by default because it doesn't work well with listing and tcb
    colback=blue!1!white,colframe=blue!75!black,colbacktitle=red!20!blue!8,
    coltitle=blue, enhanced jigsaw,
%		title=\textbf{\textit{R}}\ ,fonttitle=\it,
     %Indent for the line numbers, % use line numbers because line-breaks
      /tcb/left skip=0.5 cm, %Indent the whole box
      width=41em % make width about 80ish tt char
}
% Add Line Colour Strip
\RequirePackage{tcolorbox}
\tcbuselibrary{skins}
\tcbset{
   left=5mm, % Indent text to make room for line Numbers
   overlay={
     \begin{tcbclipinterior}\fill[red!20!blue!20!white] (frame.south west) rectangle ([xshift=5mm]frame.north west); \end{tcbclipinterior}
   }
 }
% Make verbatim smaller to fit inside box
\patchcmd{\@verbatim}
  {\verbatim@font}
  {\verbatim@font\footnotesize}
   {}{}                          %
% \BeforeBeginEnvironment{minted}{\begin{tcolorbox}[]}%
% %  \AfterEndEnvironment{verbatim}{\end{tcolorbox}}%
%  \AfterEndEnvironment{minted}{\end{tcolorbox}}%




% Wrapping with tcolorbox means there's no breaking, instead you need to use tcblisting which org mode won't export to
% using \surroundwithmdframed{} offers a fix for that
% Using listings is a work around but they tend to split across pages too frequently (and don't support many languages)
